import { Board } from "board.slint";
import { StartWindow } from "start_window.slint";
import { LanPromptWindow } from "lan_prompt_window.slint";
import { ConnectionWindow } from "connection_window.slint";

export enum WindowType {
    Start,
    LanPrompt,
    Connecting,
    Game,
}

export component GameWindow inherits Window {
    default-font-size: 32px;

    preferred-width: 400px;
    preferred-height: 400px;

    min-width: board.width;
    min-height: board.height;

    in property <WindowType> window-state: WindowType.Start;

    in property <bool> is-host <=> connecting-window.is-host;
    in property <string> join-code <=> connecting-window.join-code;

    callback exit <=> start-window.exit;
    callback join-game <=> start-window.join-game;
    callback host-game <=> start-window.host-game;
    start-window := StartWindow {
        visible: window-state == WindowType.Start;
    }

    out property <string> lan-code: lan-prompt-window.code;
    callback join-prompt <=> lan-prompt-window.join;
    lan-prompt-window := LanPromptWindow {
        visible: window-state == WindowType.LanPrompt;
    }

    connecting-window := ConnectionWindow {
       visible: window-state == WindowType.Connecting; 
    }

    // Board property links
    callback clicked <=> board.square-clicked;
    in-out property pieces <=> board.pieces;
    in-out property squares <=> board.squares;

    property <length> board-length: self.height * 85%;
    board := Board {
        square-color: #352f3b;
        back-color: #e3e0a0;
        marked-color: #ffff41;
        board-length: parent.board-length;
        center: { x: parent.width / 2, y: parent.height / 2 };
        visible: window-state == WindowType.Game;
    }
}
